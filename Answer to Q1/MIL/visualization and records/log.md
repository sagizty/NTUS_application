/usr/local/bin/python3.7 /Users/zhangtianyi/Desktop/MIL/MIL.py
cuda avaliablity: False
(10107, 784)
(2081, 784)
/usr/local/lib/python3.7/site-packages/torch/nn/modules/loss.py:96: UserWarning: Using a target size (torch.Size([])) that is different to the input size (torch.Size([1, 1])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return F.l1_loss(input, target, reduction=self.reduction)

Epoch: 1 
Training loss in each bag: 49.768488098593316 
Validate loss in each bag: 49.59342538742792

Epoch: 2 
Training loss in each bag: 46.790673489664115 
Validate loss in each bag: 46.127563113258

Epoch: 3 
Training loss in each bag: 43.03264565561332 
Validate loss in each bag: 41.672042483375186

Epoch: 4 
Training loss in each bag: 38.02706370634191 
Validate loss in each bag: 35.797035217285156

Epoch: 5 
Training loss in each bag: 31.543802990632898 
Validate loss in each bag: 28.391175406319753

Epoch: 6 
Training loss in each bag: 23.479854939030666 
Validate loss in each bag: 19.309772128150577

Epoch: 7 
Training loss in each bag: 13.83561949636422 
Validate loss in each bag: 8.909915560767764

Epoch: 8 
Training loss in each bag: 6.120151856366326 
Validate loss in each bag: 3.083909897577195

Epoch: 9 
Training loss in each bag: 4.285689896228266 
Validate loss in each bag: 3.3914962041945684

Epoch: 10 
Training loss in each bag: 4.3152257881912535 
Validate loss in each bag: 4.043023608979725

Epoch: 11 
Training loss in each bag: 4.79052079892626 
Validate loss in each bag: 3.880799066452753

Epoch: 12 
Training loss in each bag: 4.587804644715552 
Validate loss in each bag: 4.414750417073567

Epoch: 13 
Training loss in each bag: 4.368531844195197 
Validate loss in each bag: 3.625602358863467

Epoch: 14 
Training loss in each bag: 4.67510331845751 
Validate loss in each bag: 4.323602585565476

Epoch: 15 
Training loss in each bag: 4.109938528023514 
Validate loss in each bag: 4.524373917352586

Epoch: 16 
Training loss in each bag: 4.801796370861577 
Validate loss in each bag: 3.2758262270972844

Epoch: 17 
Training loss in each bag: 4.8962897506414675 
Validate loss in each bag: 5.344085148402622

Epoch: 18 
Training loss in each bag: 4.488443673825731 
Validate loss in each bag: 5.270618620372954

Epoch: 19 
Training loss in each bag: 4.70265007019043 
Validate loss in each bag: 4.196629478817894

Epoch: 20 
Training loss in each bag: 4.252869624717563 
Validate loss in each bag: 4.255795433407738

Epoch: 21 
Training loss in each bag: 4.293636995203355 
Validate loss in each bag: 4.415906451997303

Epoch: 22 
Training loss in each bag: 4.814494226493087 
Validate loss in each bag: 3.1198824927920388

Epoch: 23 
Training loss in each bag: 4.885180641623104 
Validate loss in each bag: 4.510681878952753

Epoch: 24 
Training loss in each bag: 4.110140033796722 
Validate loss in each bag: 4.154338291713169

Epoch: 25 
Training loss in each bag: 5.021873885510015 
Validate loss in each bag: 4.629024323962984

Epoch: 26 
Training loss in each bag: 4.287963231404622 
Validate loss in each bag: 2.9225269499279203

Epoch: 27 
Training loss in each bag: 4.349776922487745 
Validate loss in each bag: 3.2881664094470797

Epoch: 28 
Training loss in each bag: 4.211922327677409 
Validate loss in each bag: 6.015057881673177

Epoch: 29 
Training loss in each bag: 4.160131865856695 
Validate loss in each bag: 4.7495831080845425

Epoch: 30 
Training loss in each bag: 4.37343765707577 
Validate loss in each bag: 4.925112043108259

Process finished with exit code 0